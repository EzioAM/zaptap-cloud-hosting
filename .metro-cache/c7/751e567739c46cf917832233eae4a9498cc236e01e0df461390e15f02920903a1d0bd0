{"dependencies":[{"name":"./constants","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":6,"column":17,"index":93},"end":{"line":6,"column":39,"index":115}}],"key":"3z43bJyk/UB4EKjDCOXTFak09do=","exportNames":["*"]}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  exports.__esModule = true;\n  exports.default = createMigrate;\n  var _constants = require(_dependencyMap[0]);\n  function createMigrate(migrations, config) {\n    var _ref = config || {},\n      debug = _ref.debug;\n    return function (state, currentVersion) {\n      if (!state) {\n        return Promise.resolve(undefined);\n      }\n      var inboundVersion = state._persist && state._persist.version !== undefined ? state._persist.version : _constants.DEFAULT_VERSION;\n      if (inboundVersion === currentVersion) {\n        return Promise.resolve(state);\n      }\n      if (inboundVersion > currentVersion) {\n        return Promise.resolve(state);\n      }\n      var migrationKeys = Object.keys(migrations).map(function (ver) {\n        return parseInt(ver);\n      }).filter(function (key) {\n        return currentVersion >= key && key > inboundVersion;\n      }).sort(function (a, b) {\n        return a - b;\n      });\n      try {\n        var migratedState = migrationKeys.reduce(function (state, versionKey) {\n          return migrations[versionKey](state);\n        }, state);\n        return Promise.resolve(migratedState);\n      } catch (err) {\n        return Promise.reject(err);\n      }\n    };\n  }\n});","lineCount":38,"map":[[2,2,1,0],[2,14,1,12],[4,2,3,0,"exports"],[4,9,3,7],[4,10,3,8,"__esModule"],[4,20,3,18],[4,23,3,21],[4,27,3,25],[5,2,4,0,"exports"],[5,9,4,7],[5,10,4,8,"default"],[5,17,4,15],[5,20,4,18,"createMigrate"],[5,33,4,31],[6,2,6,0],[6,6,6,4,"_constants"],[6,16,6,14],[6,19,6,17,"require"],[6,26,6,24],[6,27,6,24,"_dependencyMap"],[6,41,6,24],[6,44,6,38],[6,45,6,39],[7,2,8,0],[7,11,8,9,"createMigrate"],[7,24,8,22,"createMigrate"],[7,25,8,23,"migrations"],[7,35,8,33],[7,37,8,35,"config"],[7,43,8,41],[7,45,8,43],[8,4,9,2],[8,8,9,6,"_ref"],[8,12,9,10],[8,15,9,13,"config"],[8,21,9,19],[8,25,9,23],[8,26,9,24],[8,27,9,25],[9,6,10,6,"debug"],[9,11,10,11],[9,14,10,14,"_ref"],[9,18,10,18],[9,19,10,19,"debug"],[9,24,10,24],[10,4,12,2],[10,11,12,9],[10,21,12,19,"state"],[10,26,12,24],[10,28,12,26,"currentVersion"],[10,42,12,40],[10,44,12,42],[11,6,13,4],[11,10,13,8],[11,11,13,9,"state"],[11,16,13,14],[11,18,13,16],[12,8,15,6],[12,15,15,13,"Promise"],[12,22,15,20],[12,23,15,21,"resolve"],[12,30,15,28],[12,31,15,29,"undefined"],[12,40,15,38],[12,41,15,39],[13,6,16,4],[14,6,18,4],[14,10,18,8,"inboundVersion"],[14,24,18,22],[14,27,18,25,"state"],[14,32,18,30],[14,33,18,31,"_persist"],[14,41,18,39],[14,45,18,43,"state"],[14,50,18,48],[14,51,18,49,"_persist"],[14,59,18,57],[14,60,18,58,"version"],[14,67,18,65],[14,72,18,70,"undefined"],[14,81,18,79],[14,84,18,82,"state"],[14,89,18,87],[14,90,18,88,"_persist"],[14,98,18,96],[14,99,18,97,"version"],[14,106,18,104],[14,109,18,107,"_constants"],[14,119,18,117],[14,120,18,118,"DEFAULT_VERSION"],[14,135,18,133],[15,6,20,4],[15,10,20,8,"inboundVersion"],[15,24,20,22],[15,29,20,27,"currentVersion"],[15,43,20,41],[15,45,20,43],[16,8,22,6],[16,15,22,13,"Promise"],[16,22,22,20],[16,23,22,21,"resolve"],[16,30,22,28],[16,31,22,29,"state"],[16,36,22,34],[16,37,22,35],[17,6,23,4],[18,6,25,4],[18,10,25,8,"inboundVersion"],[18,24,25,22],[18,27,25,25,"currentVersion"],[18,41,25,39],[18,43,25,41],[19,8,27,6],[19,15,27,13,"Promise"],[19,22,27,20],[19,23,27,21,"resolve"],[19,30,27,28],[19,31,27,29,"state"],[19,36,27,34],[19,37,27,35],[20,6,28,4],[21,6,30,4],[21,10,30,8,"migrationKeys"],[21,23,30,21],[21,26,30,24,"Object"],[21,32,30,30],[21,33,30,31,"keys"],[21,37,30,35],[21,38,30,36,"migrations"],[21,48,30,46],[21,49,30,47],[21,50,30,48,"map"],[21,53,30,51],[21,54,30,52],[21,64,30,62,"ver"],[21,67,30,65],[21,69,30,67],[22,8,31,6],[22,15,31,13,"parseInt"],[22,23,31,21],[22,24,31,22,"ver"],[22,27,31,25],[22,28,31,26],[23,6,32,4],[23,7,32,5],[23,8,32,6],[23,9,32,7,"filter"],[23,15,32,13],[23,16,32,14],[23,26,32,24,"key"],[23,29,32,27],[23,31,32,29],[24,8,33,6],[24,15,33,13,"currentVersion"],[24,29,33,27],[24,33,33,31,"key"],[24,36,33,34],[24,40,33,38,"key"],[24,43,33,41],[24,46,33,44,"inboundVersion"],[24,60,33,58],[25,6,34,4],[25,7,34,5],[25,8,34,6],[25,9,34,7,"sort"],[25,13,34,11],[25,14,34,12],[25,24,34,22,"a"],[25,25,34,23],[25,27,34,25,"b"],[25,28,34,26],[25,30,34,28],[26,8,35,6],[26,15,35,13,"a"],[26,16,35,14],[26,19,35,17,"b"],[26,20,35,18],[27,6,36,4],[27,7,36,5],[27,8,36,6],[28,6,39,4],[28,10,39,8],[29,8,40,6],[29,12,40,10,"migratedState"],[29,25,40,23],[29,28,40,26,"migrationKeys"],[29,41,40,39],[29,42,40,40,"reduce"],[29,48,40,46],[29,49,40,47],[29,59,40,57,"state"],[29,64,40,62],[29,66,40,64,"versionKey"],[29,76,40,74],[29,78,40,76],[30,10,42,8],[30,17,42,15,"migrations"],[30,27,42,25],[30,28,42,26,"versionKey"],[30,38,42,36],[30,39,42,37],[30,40,42,38,"state"],[30,45,42,43],[30,46,42,44],[31,8,43,6],[31,9,43,7],[31,11,43,9,"state"],[31,16,43,14],[31,17,43,15],[32,8,44,6],[32,15,44,13,"Promise"],[32,22,44,20],[32,23,44,21,"resolve"],[32,30,44,28],[32,31,44,29,"migratedState"],[32,44,44,42],[32,45,44,43],[33,6,45,4],[33,7,45,5],[33,8,45,6],[33,15,45,13,"err"],[33,18,45,16],[33,20,45,18],[34,8,46,6],[34,15,46,13,"Promise"],[34,22,46,20],[34,23,46,21,"reject"],[34,29,46,27],[34,30,46,28,"err"],[34,33,46,31],[34,34,46,32],[35,6,47,4],[36,4,48,2],[36,5,48,3],[37,2,49,0],[38,0,49,1],[38,3]],"functionMap":{"names":["<global>","createMigrate","<anonymous>","Object.keys.map$argument_0","Object.keys.map.filter$argument_0","Object.keys.map.filter.sort$argument_0","migrationKeys.reduce$argument_0"],"mappings":"AAA;ACO;SCI;oDCkB;KDE,SE;KFE,OG;KHE;+CII;OJG;GDK"}},"type":"js/module"}]}