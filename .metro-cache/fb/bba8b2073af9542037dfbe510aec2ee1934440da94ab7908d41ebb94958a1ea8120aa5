{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"kslwqCIsh6ew+I1KeA1rlVRjsAk=","exportNames":["*"]}},{"name":"./ExpoUpdates","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":46,"index":46}}],"key":"xvfiwKXsFVvB05bziLrxffeS3bo=","exportNames":["*"]}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = require(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.resetLatestContext = exports.latestContext = exports.emitTestStateChangeEvent = exports.addUpdatesStateChangeListener = void 0;\n  var _ExpoUpdates = _interopRequireDefault(require(_dependencyMap[1], \"./ExpoUpdates\"));\n  var latestContext = exports.latestContext = transformNativeStateMachineContext(_ExpoUpdates.default.initialContext);\n  _ExpoUpdates.default.addListener('Expo.nativeUpdatesStateChangeEvent', _handleNativeStateChangeEvent);\n  var _updatesStateChangeListeners = new Set();\n  // Reemits native state change events\n  function _handleNativeStateChangeEvent(params) {\n    var newParams = typeof params === 'string' ? JSON.parse(params) : Object.assign({}, params);\n    var transformedContext = transformNativeStateMachineContext(newParams.context);\n    // only process state change events if they are in order\n    if (transformedContext.sequenceNumber <= latestContext.sequenceNumber) {\n      return;\n    }\n    newParams.context = transformedContext;\n    exports.latestContext = latestContext = transformedContext;\n    _updatesStateChangeListeners.forEach(function (listener) {\n      return listener(newParams);\n    });\n  }\n  /**\n   * Add listener for state change events\n   * @hidden\n   */\n  var addUpdatesStateChangeListener = exports.addUpdatesStateChangeListener = function addUpdatesStateChangeListener(listener) {\n    _updatesStateChangeListeners.add(listener);\n    return {\n      remove: function remove() {\n        _updatesStateChangeListeners.delete(listener);\n      }\n    };\n  };\n  /**\n   * Allows JS test to emit a simulated native state change event (used in unit testing)\n   * @hidden\n   */\n  var emitTestStateChangeEvent = exports.emitTestStateChangeEvent = function emitTestStateChangeEvent(event) {\n    _handleNativeStateChangeEvent(event);\n  };\n  /**\n   * Allows JS test to reset latest context (and sequence number)\n   * @hidden\n   */\n  var resetLatestContext = exports.resetLatestContext = function resetLatestContext() {\n    exports.latestContext = latestContext = transformNativeStateMachineContext(_ExpoUpdates.default.initialContext);\n  };\n  function transformNativeStateMachineContext(originalNativeContext) {\n    var nativeContext = Object.assign({}, originalNativeContext);\n    if (nativeContext.latestManifestString) {\n      nativeContext.latestManifest = JSON.parse(nativeContext.latestManifestString);\n      delete nativeContext.latestManifestString;\n    }\n    if (nativeContext.downloadedManifestString) {\n      nativeContext.downloadedManifest = JSON.parse(nativeContext.downloadedManifestString);\n      delete nativeContext.downloadedManifestString;\n    }\n    if (nativeContext.lastCheckForUpdateTimeString) {\n      nativeContext.lastCheckForUpdateTime = new Date(nativeContext.lastCheckForUpdateTimeString);\n      delete nativeContext.lastCheckForUpdateTimeString;\n    }\n    if (nativeContext.rollbackString) {\n      nativeContext.rollback = JSON.parse(nativeContext.rollbackString);\n      delete nativeContext.rollbackString;\n    }\n    return nativeContext;\n  }\n});","lineCount":71,"map":[[7,2,1,0],[7,6,1,0,"_ExpoUpdates"],[7,18,1,0],[7,21,1,0,"_interopRequireDefault"],[7,43,1,0],[7,44,1,0,"require"],[7,51,1,0],[7,52,1,0,"_dependencyMap"],[7,66,1,0],[8,2,2,7],[8,6,2,11,"latestContext"],[8,19,2,24],[8,22,2,24,"exports"],[8,29,2,24],[8,30,2,24,"latestContext"],[8,43,2,24],[8,46,2,27,"transformNativeStateMachineContext"],[8,80,2,61],[8,81,2,62,"ExpoUpdatesModule"],[8,101,2,79],[8,102,2,80,"initialContext"],[8,116,2,94],[8,117,2,95],[9,2,3,0,"ExpoUpdatesModule"],[9,22,3,17],[9,23,3,18,"addListener"],[9,34,3,29],[9,35,3,30],[9,71,3,66],[9,73,3,68,"_handleNativeStateChangeEvent"],[9,102,3,97],[9,103,3,98],[10,2,4,0],[10,6,4,6,"_updatesStateChangeListeners"],[10,34,4,34],[10,37,4,37],[10,41,4,41,"Set"],[10,44,4,44],[10,45,4,45],[10,46,4,46],[11,2,5,0],[12,2,6,0],[12,11,6,9,"_handleNativeStateChangeEvent"],[12,40,6,38,"_handleNativeStateChangeEvent"],[12,41,6,39,"params"],[12,47,6,45],[12,49,6,47],[13,4,7,4],[13,8,7,10,"newParams"],[13,17,7,19],[13,20,7,22],[13,27,7,29,"params"],[13,33,7,35],[13,38,7,40],[13,46,7,48],[13,49,7,51,"JSON"],[13,53,7,55],[13,54,7,56,"parse"],[13,59,7,61],[13,60,7,62,"params"],[13,66,7,68],[13,67,7,69],[13,70,7,69,"Object"],[13,76,7,69],[13,77,7,69,"assign"],[13,83,7,69],[13,88,7,77,"params"],[13,94,7,83],[13,95,7,85],[14,4,8,4],[14,8,8,10,"transformedContext"],[14,26,8,28],[14,29,8,31,"transformNativeStateMachineContext"],[14,63,8,65],[14,64,8,66,"newParams"],[14,73,8,75],[14,74,8,76,"context"],[14,81,8,83],[14,82,8,84],[15,4,9,4],[16,4,10,4],[16,8,10,8,"transformedContext"],[16,26,10,26],[16,27,10,27,"sequenceNumber"],[16,41,10,41],[16,45,10,45,"latestContext"],[16,58,10,58],[16,59,10,59,"sequenceNumber"],[16,73,10,73],[16,75,10,75],[17,6,11,8],[18,4,12,4],[19,4,13,4,"newParams"],[19,13,13,13],[19,14,13,14,"context"],[19,21,13,21],[19,24,13,24,"transformedContext"],[19,42,13,42],[20,4,14,4,"exports"],[20,11,14,4],[20,12,14,4,"latestContext"],[20,25,14,4],[20,28,14,4,"latestContext"],[20,41,14,17],[20,44,14,20,"transformedContext"],[20,62,14,38],[21,4,15,4,"_updatesStateChangeListeners"],[21,32,15,32],[21,33,15,33,"forEach"],[21,40,15,40],[21,41,15,41],[21,51,15,42,"listener"],[21,59,15,50],[22,6,15,50],[22,13,15,55,"listener"],[22,21,15,63],[22,22,15,64,"newParams"],[22,31,15,73],[22,32,15,74],[23,4,15,74],[23,6,15,75],[24,2,16,0],[25,2,17,0],[26,0,18,0],[27,0,19,0],[28,0,20,0],[29,2,21,7],[29,6,21,13,"addUpdatesStateChangeListener"],[29,35,21,42],[29,38,21,42,"exports"],[29,45,21,42],[29,46,21,42,"addUpdatesStateChangeListener"],[29,75,21,42],[29,78,21,45],[29,87,21,13,"addUpdatesStateChangeListener"],[29,116,21,42,"addUpdatesStateChangeListener"],[29,117,21,46,"listener"],[29,125,21,54],[29,127,21,59],[30,4,22,4,"_updatesStateChangeListeners"],[30,32,22,32],[30,33,22,33,"add"],[30,36,22,36],[30,37,22,37,"listener"],[30,45,22,45],[30,46,22,46],[31,4,23,4],[31,11,23,11],[32,6,24,8,"remove"],[32,12,24,14],[32,23,24,8,"remove"],[32,29,24,14,"remove"],[32,30,24,14],[32,32,24,17],[33,8,25,12,"_updatesStateChangeListeners"],[33,36,25,40],[33,37,25,41,"delete"],[33,43,25,47],[33,44,25,48,"listener"],[33,52,25,56],[33,53,25,57],[34,6,26,8],[35,4,27,4],[35,5,27,5],[36,2,28,0],[36,3,28,1],[37,2,29,0],[38,0,30,0],[39,0,31,0],[40,0,32,0],[41,2,33,7],[41,6,33,13,"emitTestStateChangeEvent"],[41,30,33,37],[41,33,33,37,"exports"],[41,40,33,37],[41,41,33,37,"emitTestStateChangeEvent"],[41,65,33,37],[41,68,33,40],[41,77,33,13,"emitTestStateChangeEvent"],[41,101,33,37,"emitTestStateChangeEvent"],[41,102,33,41,"event"],[41,107,33,46],[41,109,33,51],[42,4,34,4,"_handleNativeStateChangeEvent"],[42,33,34,33],[42,34,34,34,"event"],[42,39,34,39],[42,40,34,40],[43,2,35,0],[43,3,35,1],[44,2,36,0],[45,0,37,0],[46,0,38,0],[47,0,39,0],[48,2,40,7],[48,6,40,13,"resetLatestContext"],[48,24,40,31],[48,27,40,31,"exports"],[48,34,40,31],[48,35,40,31,"resetLatestContext"],[48,53,40,31],[48,56,40,34],[48,65,40,13,"resetLatestContext"],[48,83,40,31,"resetLatestContext"],[48,84,40,31],[48,86,40,40],[49,4,41,4,"exports"],[49,11,41,4],[49,12,41,4,"latestContext"],[49,25,41,4],[49,28,41,4,"latestContext"],[49,41,41,17],[49,44,41,20,"transformNativeStateMachineContext"],[49,78,41,54],[49,79,41,55,"ExpoUpdatesModule"],[49,99,41,72],[49,100,41,73,"initialContext"],[49,114,41,87],[49,115,41,88],[50,2,42,0],[50,3,42,1],[51,2,43,0],[51,11,43,9,"transformNativeStateMachineContext"],[51,45,43,43,"transformNativeStateMachineContext"],[51,46,43,44,"originalNativeContext"],[51,67,43,65],[51,69,43,67],[52,4,44,4],[52,8,44,10,"nativeContext"],[52,21,44,23],[52,24,44,23,"Object"],[52,30,44,23],[52,31,44,23,"assign"],[52,37,44,23],[52,42,44,31,"originalNativeContext"],[52,63,44,52],[52,64,44,54],[53,4,45,4],[53,8,45,8,"nativeContext"],[53,21,45,21],[53,22,45,22,"latestManifestString"],[53,42,45,42],[53,44,45,44],[54,6,46,8,"nativeContext"],[54,19,46,21],[54,20,46,22,"latestManifest"],[54,34,46,36],[54,37,46,39,"JSON"],[54,41,46,43],[54,42,46,44,"parse"],[54,47,46,49],[54,48,46,50,"nativeContext"],[54,61,46,63],[54,62,46,64,"latestManifestString"],[54,82,46,84],[54,83,46,85],[55,6,47,8],[55,13,47,15,"nativeContext"],[55,26,47,28],[55,27,47,29,"latestManifestString"],[55,47,47,49],[56,4,48,4],[57,4,49,4],[57,8,49,8,"nativeContext"],[57,21,49,21],[57,22,49,22,"downloadedManifestString"],[57,46,49,46],[57,48,49,48],[58,6,50,8,"nativeContext"],[58,19,50,21],[58,20,50,22,"downloadedManifest"],[58,38,50,40],[58,41,50,43,"JSON"],[58,45,50,47],[58,46,50,48,"parse"],[58,51,50,53],[58,52,50,54,"nativeContext"],[58,65,50,67],[58,66,50,68,"downloadedManifestString"],[58,90,50,92],[58,91,50,93],[59,6,51,8],[59,13,51,15,"nativeContext"],[59,26,51,28],[59,27,51,29,"downloadedManifestString"],[59,51,51,53],[60,4,52,4],[61,4,53,4],[61,8,53,8,"nativeContext"],[61,21,53,21],[61,22,53,22,"lastCheckForUpdateTimeString"],[61,50,53,50],[61,52,53,52],[62,6,54,8,"nativeContext"],[62,19,54,21],[62,20,54,22,"lastCheckForUpdateTime"],[62,42,54,44],[62,45,54,47],[62,49,54,51,"Date"],[62,53,54,55],[62,54,54,56,"nativeContext"],[62,67,54,69],[62,68,54,70,"lastCheckForUpdateTimeString"],[62,96,54,98],[62,97,54,99],[63,6,55,8],[63,13,55,15,"nativeContext"],[63,26,55,28],[63,27,55,29,"lastCheckForUpdateTimeString"],[63,55,55,57],[64,4,56,4],[65,4,57,4],[65,8,57,8,"nativeContext"],[65,21,57,21],[65,22,57,22,"rollbackString"],[65,36,57,36],[65,38,57,38],[66,6,58,8,"nativeContext"],[66,19,58,21],[66,20,58,22,"rollback"],[66,28,58,30],[66,31,58,33,"JSON"],[66,35,58,37],[66,36,58,38,"parse"],[66,41,58,43],[66,42,58,44,"nativeContext"],[66,55,58,57],[66,56,58,58,"rollbackString"],[66,70,58,72],[66,71,58,73],[67,6,59,8],[67,13,59,15,"nativeContext"],[67,26,59,28],[67,27,59,29,"rollbackString"],[67,41,59,43],[68,4,60,4],[69,4,61,4],[69,11,61,11,"nativeContext"],[69,24,61,24],[70,2,62,0],[71,0,62,1],[71,3]],"functionMap":{"names":["<global>","_handleNativeStateChangeEvent","_updatesStateChangeListeners.forEach$argument_0","addUpdatesStateChangeListener","remove","emitTestStateChangeEvent","resetLatestContext","transformNativeStateMachineContext"],"mappings":"AAA;ACK;yCCS,iCD;CDC;6CGK;QCG;SDE;CHE;wCKK;CLE;kCMK;CNE;AOC;CPmB"}},"type":"js/module"}]}